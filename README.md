# AI Data Platform on TrueNAS Scale

TrueNAS Scaleä¸Šã§å‹•ä½œã™ã‚‹AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå‘ã‘ãƒ‡ãƒ¼ã‚¿åŸºç›¤

## ğŸš€ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–‹ç™ºã®ãŸã‚ã®åŒ…æ‹¬çš„ãªãƒ‡ãƒ¼ã‚¿åŸºç›¤ã§ã™ã€‚ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã€ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã€æ©Ÿæ¢°å­¦ç¿’ã€APIæä¾›ã¾ã§ä¸€è²«ã—ãŸãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æä¾›ã—ã¾ã™ã€‚

## ğŸ“Š ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³

### âœ… å®Œæˆæ¸ˆã¿æ©Ÿèƒ½

#### ğŸ—ï¸ ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£
- **Docker Compose**: é–‹ç™ºç’°å¢ƒã®å®Œå…¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- **Kubernetes**: æœ¬ç•ªç’°å¢ƒç”¨ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ
- **ç’°å¢ƒè¨­å®š**: `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã‚‹è¨­å®šç®¡ç†

#### ğŸ’¾ ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å±¤
- **PostgreSQL 15**: æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ï¼ˆç”»åƒãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã€ã‚¸ãƒ§ãƒ–å±¥æ­´ï¼‰
- **MongoDB 7**: éæ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ï¼ˆç”Ÿã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ï¼‰
- **Redis 7**: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
- **MinIO**: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

#### ğŸ”„ ãƒ‡ãƒ¼ã‚¿å‡¦ç†å±¤
- **Apache Airflow 2.7.3**: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç®¡ç†
  - ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
  - ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
  - ãƒ‡ãƒ¼ã‚¿å“è³ªãƒã‚§ãƒƒã‚¯
- **ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹**: 
  - ãƒ™ãƒ¼ã‚¹ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹
  - ç”»åƒã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°æ©Ÿèƒ½
  - wandbé€£æºã«ã‚ˆã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹è¿½è·¡

#### ğŸŒ APIå±¤
- **FastAPI**: RESTful API
  - ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
  - å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆç”Ÿæˆ
  - åˆ†æãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½
- **Pydantic**: ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«å®šç¾©

#### ğŸ“ˆ åˆ†æãƒ»å¯è¦–åŒ–å±¤
- **JupyterHub**: ãƒ‡ãƒ¼ã‚¿åˆ†æç’°å¢ƒ
- **Grafana**: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ»å¯è¦–åŒ–
- **wandb/MLflow**: MLå®Ÿé¨“ç®¡ç†

### ğŸ”§ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

```yaml
ã‚³ãƒ³ãƒ†ãƒŠ: Docker/Kubernetes
ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼: Apache Airflow 2.7.3
API: FastAPI + Uvicorn
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: PostgreSQL 15, MongoDB 7
ã‚­ãƒ£ãƒƒã‚·ãƒ¥: Redis 7
ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: MinIO
ç›£è¦–: Grafana + Prometheus
MLè¿½è·¡: wandb, MLflow
```

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
TrueNAS Scale (Kubernetes)
â”œâ”€â”€ Data Collection Layer
â”‚   â”œâ”€â”€ Airflow (ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç®¡ç†) âœ…
â”‚   â”œâ”€â”€ Scraping Services (ã‚³ãƒ³ãƒ†ãƒŠåŒ–æ¸ˆã¿) âœ…
â”‚   â””â”€â”€ Data Ingestion APIs âœ…
â”œâ”€â”€ Data Storage Layer
â”‚   â”œâ”€â”€ PostgreSQL (æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿) âœ…
â”‚   â”œâ”€â”€ MongoDB (éæ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿) âœ…
â”‚   â”œâ”€â”€ Redis (ã‚­ãƒ£ãƒƒã‚·ãƒ¥) âœ…
â”‚   â””â”€â”€ MinIO (ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸) âœ…
â”œâ”€â”€ Data Processing Layer
â”‚   â”œâ”€â”€ Jupyter Hub (ãƒ‡ãƒ¼ã‚¿åˆ†æ) âœ…
â”‚   â”œâ”€â”€ MLflow (MLå®Ÿé¨“ç®¡ç†) âœ…
â”‚   â””â”€â”€ wandb (ãƒ‡ãƒ¼ã‚¿è¿½è·¡) âœ…
â”œâ”€â”€ API Layer
â”‚   â”œâ”€â”€ FastAPI (ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹) âœ…
â”‚   â””â”€â”€ GraphQL (æŸ”è»Ÿãªã‚¯ã‚¨ãƒª) ğŸ”„
â””â”€â”€ Monitoring
    â”œâ”€â”€ Grafana (å¯è¦–åŒ–) âœ…
    â””â”€â”€ Prometheus (ãƒ¡ãƒˆãƒªã‚¯ã‚¹) ğŸ”„
```

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
data-platform/
â”œâ”€â”€ .env                    # ç’°å¢ƒå¤‰æ•°è¨­å®š
â”œâ”€â”€ docker-compose.yml      # é–‹ç™ºç’°å¢ƒè¨­å®š
â”œâ”€â”€ USAGE.md               # ä½¿ç”¨æ–¹æ³•è©³ç´°
â”œâ”€â”€ airflow/               # Airflowè¨­å®š
â”‚   â””â”€â”€ dags/              # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®šç¾©
â”œâ”€â”€ api/                   # FastAPI ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”œâ”€â”€ main.py            # APIã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ models.py          # ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ database.py        # DBæ¥ç¶šç®¡ç†
â”‚   â””â”€â”€ services.py        # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€â”€ scraping/              # ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹
â”‚   â”œâ”€â”€ base_scraper.py    # ãƒ™ãƒ¼ã‚¹ã‚¯ãƒ©ã‚¹
â”‚   â””â”€â”€ image_scraper.py   # ç”»åƒã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°
â”œâ”€â”€ docker/                # Dockerfiles
â”‚   â”œâ”€â”€ airflow/           # Airflowç”¨
â”‚   â””â”€â”€ api/               # APIç”¨
â”œâ”€â”€ config/                # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ postgres/          # PostgreSQLåˆæœŸåŒ–
â”‚   â””â”€â”€ grafana/           # Grafanaè¨­å®š
â”œâ”€â”€ kubernetes/            # K8s ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ
â””â”€â”€ scripts/               # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### 1. ç’°å¢ƒè¨­å®š

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³
git clone <repository-url>
cd data-platform

# ç’°å¢ƒå¤‰æ•°è¨­å®š
cp .env.example .env
# å¿…è¦ã«å¿œã˜ã¦ .env ã‚’ç·¨é›†
```

### 2. é–‹ç™ºç’°å¢ƒèµ·å‹•

```bash
# å…¨ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•
docker-compose up -d

# å€‹åˆ¥ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•
docker-compose up -d postgres mongodb redis minio  # ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å±¤
docker-compose up -d airflow-webserver airflow-scheduler  # Airflow
docker-compose up -d api  # FastAPI
```

### 3. ã‚¢ã‚¯ã‚»ã‚¹æƒ…å ±

| ã‚µãƒ¼ãƒ“ã‚¹ | URL | èªè¨¼æƒ…å ± |
|---------|-----|---------|
| Airflow | http://localhost:8080 | admin/admin123 |
| FastAPI | http://localhost:8000 | - |
| Grafana | http://localhost:3000 | admin/admin123 |
| JupyterHub | http://localhost:8888 | - |
| MinIO Console | http://localhost:9001 | admin/admin123 |

## ğŸ“ˆ ä½¿ç”¨ä¾‹

### ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã‚¸ãƒ§ãƒ–å®Ÿè¡Œ

```python
from scraping.image_scraper import ImageScraper

config = {
    'base_url': 'https://example.com',
    'download_images': True,
    'storage_path': '/data/images'
}

scraper = ImageScraper(config)
result = scraper.run()
```

### APIçµŒç”±ã§ãƒ‡ãƒ¼ã‚¿å–å¾—

```bash
# ãƒ‡ãƒ¼ã‚¿ã‚µãƒãƒªãƒ¼å–å¾—
curl http://localhost:8000/api/v1/data/summary

# å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆç”Ÿæˆ
curl -X POST http://localhost:8000/api/v1/training/dataset \
  -H "Content-Type: application/json" \
  -d '{"limit": 1000, "format": "json"}'
```

## ğŸ”„ æ¬¡ã®é–‹ç™ºäºˆå®š

- [ ] GraphQL APIå®Ÿè£…
- [ ] Prometheusç›£è¦–è¨­å®š
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ©Ÿèƒ½æ‹¡å¼µ
- [ ] è‡ªå‹•ãƒ†ã‚¹ãƒˆè¿½åŠ 

## ğŸ“š è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [ä½¿ç”¨æ–¹æ³•è©³ç´°](USAGE.md)
- [APIä»•æ§˜æ›¸](http://localhost:8000/docs) (èµ·å‹•å¾Œ)
- [Airflow DAGs](airflow/dags/)

## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

1. Fork the repository
2. Create your feature branch
3. Commit your changes
4. Push to the branch
5. Create a Pull Request